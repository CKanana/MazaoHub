<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/CSS files/Soko.css">
    <title>Document</title>
</head>
<body>
    <nav>
        <div class="icon">
            <img src= "../Assets/Green and White Plants Organic Logo.png"alt="Mazao Hub Logo"/>
            <h1>MazaoHub</h1>
        </div>
        <div class="navmenu">
            <ul>
                <li><a href="/homepage.html">Home</a></li>
                <li><a href="/AboutUs.html">About</a></li>
                <li><a href="/Soko.html">Soko</a></li>
                <li><a href="/blog.html">Blog</a></li>
                <li><a href="/FAQs.html">FAQs</a></li>
              
            </ul>
        </div>
        <div class="login">
           
            <a href="signup.html" class="Lbtn">Login/Signup</a>
        </div>
    </nav>
    <div class="sidebar">
        <h2 class="sidebar-title">Categories</h2>
        <ul class="sidebar-list">
            <li class="sidebar-item active">Fruits</li>
            <li class="sidebar-item">Vegetables</li>
            <li class="sidebar-item">Dairy </li>
            <li class="sidebar-item">Grains</li>
            <li class="sidebar-item">Poultry</li>
            <li class="sidebar-item">Meat</li>
      
    </div>

    <div class="recommend">
        <h1>Recommended</h1>
        <div class="recommend-btns">
           
            <button>Greens</button>
            <button>Honey</button>
            <button>Meat</button>
            <button>Fruits</button>
            <button>Fertilizer</button>

        </div>
        </div>

        <div class="container" id="product-container"></div>

        <script>
            async function loadProducts() {
    try {
        const response = await fetch('http://localhost:3000/api/products');
        const products = await response.json();
        
        const productContainer = document.getElementById('product-container');
        productContainer.innerHTML = '';  

        products.forEach(product => {
            const productCard = document.createElement('div');
            productCard.classList.add('card');
            
            
            productCard.innerHTML = `
                <img src="../${product.ProductImagePath}" alt="${product.ProductName}" class="card-img" />
                <div class="card-details">
                    <h3 class="card-title">${product.ProductName}</h3>
                    <p>${product.Caption}</p>
                    <div class="reviews-section">
                        <span class="rating">⭐⭐⭐⭐⭐</span>
                        <span class="total-reviews">(10 reviews)</span>
                    </div>
                    <section class="card-price">
                        <div class="price">Ksh ${product.Price}</div>
                    </section>
                    <button class="cartbtn">Add to Cart</button>
                </div>
            `;
            
           
            productContainer.appendChild(productCard);
        });

        
        const addToCartButtons = document.querySelectorAll('.cartbtn');
        addToCartButtons.forEach(button => {
            button.addEventListener('click', addToCart);
        });

    } catch (error) {
        console.error('Error loading products:', error);
    }
}


function addToCart(event) {
    alert('You clicked on Add to Cart');
    const productCard = event.target.closest('.card');  
    const productId = productCard.dataset.productId;
    const productName = productCard.querySelector('.card-title').innerText;
    const productPrice = productCard.querySelector('.price').innerText.replace('Ksh ', '').trim();
    const productImage = productCard.querySelector('img').src;


    const product = {
        id: productId,
        name: productName,
        price: productPrice,
        image: productImage
    };

   
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

  
    cart.push(product);

   
    localStorage.setItem('cart', JSON.stringify(cart));

    alert(`${productName} has been added to your cart!`);
}


window.onload = loadProducts;
         </script>
</body>
</html>